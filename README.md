## The performance of joint longitudinal and time to event models under informative mechanisms of delayed entry: A simulation study and application to Amyotrophic Lateral Sclerosis cohort data.

Authors: James Rooney<sup>1,2</sup>, Mark Heverin<sup>2</sup>, Orla Hardiman<sup>2,3</sup>, Jack Wilkinson<sup>4</sup>

<sup>
1. Institute and Clinic for Occupational, Social- and Environmental Medicine, University Hospital, LMU Munich, Germany
2. Academic Unit of Neurology, Trinity Biomedical Sciences Institute, Trinity College Dublin, Ireland
3. Beaumont Hospital, Glasnevin, Dublin 9, Ireland.
4. Centre for Biostatistics, University of Manchester, Manchester, UK
</sup>

This repo contains R code for the paper of the same name. Specifcally this includes the following:

1. Rmarkdown file ALS_cohort_analysis.Rmd which performs the cohort analysis from the paper and the ALS_cohort_analysis.pdf which details the results of the analysis.

2. R files for the simulation study included in the paper in the directory Rscripts. To recreate the simulation the following files are needed:
    1. simJM_data.R - this file performs the mathematically simulation of s single joint longitudinal and time to event dataset.
    2. Gen_sim_data.R - this file uses simJM_data.R to simulated the various datasets used in the simulation study.
    3. Fit_sim_models.R - this file fits Cox models, linear mixed models and joint models to the data generated by Gen_sim_data.R. Cox models and linear mixed models are stored in the directory "Results/Sim_sub-models". Joint models are stored in the directory "Results/Sim_JMs".
    4. Extract_simJM_estimates.R - this file extracts the joint model parameter estimates from the joint models produced by Fit_sim_models.R and performs the calculation of MSE, bias, and coverage reported in the paper.
    5. Extract_simCoxLMM_estimates.R - this file extracts the Cox model and linear mixed model estimates from these sub-models reported in the supplementary data of the paper.


### Note if you plan to run the simulation

The simulation as run for the paper includes 1000 generated datasets for each of 5 different data generating scenarios. In addition, to each dataset 6 different joint models were fit. This was carried out on an 8core Macbook pro with 64GB RAM and required several weeks to perform. If you wish to run the simulation yourself for test purposes and do not have similar hardward available, we recommend that you edit the value of M (the number of simulated datasets for each data generating scenario) in the Gen_sim_data.R from 1000 to a lower number such as 50 for an initial run through of the code. In addition, the number of workers in the line of code 'plan(multisession, workers = 12, gc=TRUE)' determines the number of virtual cpu cores to use and we recommend you set this to a size suited for your computer. Note that at M = 1000, each worker needs at least 4GB of available RAM, although this RAM requirement is lower if you have descreased the value of M.


